```markdown
# 登录功能 API 文档

## 前端 API 接口

### 1. 账号密码登录

**请求方式**  
`POST /api/auth/login`

**请求参数**
```json
{
  "account": "string",    // 用户名或邮箱
  "password": "string",   // 密码
  "remember": "boolean"   // 是否记住登录状态
}
```

**响应示例 (成功)**
```json
{
  "code": "success",
  "data": {
    "user_name": "string",
    "roles": ["string"],
    "powers": [number],
    "token": "string",
    "avatar_url": "string"
  }
}
```

**响应示例 (失败)**
```json
{
  "code": "error",
  "msg": "账号或密码错误"
}
```

---

### 2. 验证码登录

**请求方式**  
`POST /api/auth/login/code`

**请求参数**
```json
{
  "email": "string",     // 邮箱地址
  "code": "string",      // 验证码
  "remember": "boolean"  // 是否记住登录状态
}
```

**响应示例 (成功)**
```json
{
  "code": "success",
  "data": {
    "user_name": "string",
    "roles": ["string"],
    "powers": [number],
    "token": "string",
    "avatar_url": "string"
  }
}
```

**响应示例 (失败)**
```json
{
  "code": "error",
  "msg": "验证码无效或已过期"
}
```

---

### 3. 发送验证码

**请求方式**  
`POST /api/auth/code`

**请求参数**
```json
{
  "email": "string"  // 邮箱地址
}
```

**响应示例 (成功)**
```json
{
  "code": "success"
}
```

**响应示例 (失败)**
```json
{
  "code": "error",
  "msg": "邮箱格式不正确"
}
```

---

### 4. ROOT用户登录

**请求方式**  
`POST /api/auth/root`

**请求参数**
```json
{
  "username": "string",  // ROOT用户名
  "password": "string",  // ROOT密码
  "remember": "boolean"  // 是否记住登录状态
}
```

**响应示例 (成功)**
```json
{
  "code": "success",
  "data": {
    "user_name": "string",
    "roles": ["string"],
    "powers": [number],
    "token": "string",
    "avatar_url": "string"
  }
}
```

**响应示例 (失败)**
```json
{
  "code": "error",
  "msg": "ROOT权限验证失败"
}
```

---

## 前端状态管理 (Pinia)

### Auth Store 方法

| 方法名                | 参数                  | 说明                          |
|-----------------------|-----------------------|-----------------------------|
| `setUser`             | `userData: Object`    | 设置用户信息并持久化到本地存储       |
| `clearUser`           | -                     | 清除用户信息和登录状态            |
| `loadUserFromStorage` | -                     | 从本地存储加载用户信息            |

### 用户数据结构
```typescript
interface User {
  user_name: string;
  roles: string[];
  powers: number[];
  token: string;
  avatar_url: string;
}
```

---

## 后端接口规范

### 通用响应格式
```json
{
  "code": "string",  // success/error
  "msg": "string",   // 可选，错误信息
  "data": {}         // 可选，响应数据
}
```

### 错误代码
| 代码           | HTTP状态码 | 说明                 |
|----------------|------------|---------------------|
| INVALID_CRED  | 401        | 无效的凭据            |
| CODE_EXPIRED  | 403        | 验证码已过期          |
| RATE_LIMIT    | 429        | 请求过于频繁          |
| SERVER_ERROR  | 500        | 服务器内部错误        |

---

## 前端路由

| 路径               | 组件       | 权限要求       |
|--------------------|------------|---------------|
| `/login`          | Login      | 未登录用户      |
| `/register`       | Register   | 未登录用户      |
| `/forgot-password`| ForgotPass | 未登录用户      |
| `/root`           | RootPanel  | ROOT权限       |

---

## 测试账号

### 普通用户
```
账号: user
密码: z423z423
```

### ROOT用户
```
账号: root
密码: [请联系管理员获取]
```
